# å…«å­—è®¡ç®—APIé›†æˆæ€»ç»“

## ğŸ¯ é¡¹ç›®ç›®æ ‡
å°†å‰ç«¯é¡µé¢å’Œåç«¯å…«å­—è®¡ç®—APIå¯¹æ¥èµ·æ¥ï¼Œä½¿ç”¨çœŸå®çš„å…«å­—è®¡ç®—åŠŸèƒ½ã€‚

## âœ… å·²å®Œæˆçš„å·¥ä½œ

### 1. åç«¯APIå¼€å‘
- **æŠ€æœ¯æ ˆ**: Python + Flask + sxtwl
- **ç«¯å£**: 5001 (é¿å…ä¸macOS AirPlayå†²çª)
- **APIç«¯ç‚¹**:
  - `GET /api/health` - å¥åº·æ£€æŸ¥
  - `POST /api/calculate-bazi` - å…«å­—è®¡ç®—
  - `POST /api/match-deities` - ç¥ä»™åŒ¹é…
  - `POST /api/analyze-bazi` - è¯¦ç»†åˆ†æ

### 2. å‰ç«¯APIå®¢æˆ·ç«¯
- **æ–‡ä»¶**: `frontend/src/services/apiClient.ts`
- **åŠŸèƒ½**: 
  - APIè¯·æ±‚å°è£…
  - é”™è¯¯å¤„ç†
  - å“åº”ç±»å‹å®šä¹‰
  - å¥åº·æ£€æŸ¥

### 3. å¢å¼ºçš„å…«å­—æœåŠ¡
- **æ–‡ä»¶**: `frontend/src/services/enhancedBaziService.ts`
- **åŠŸèƒ½**:
  - çœŸå®APIè°ƒç”¨
  - æœ¬åœ°æ•°æ®ç¼“å­˜
  - é™çº§å¤„ç†
  - æ•°æ®è½¬æ¢

### 4. è®¾ç½®é¡µé¢æ›´æ–°
- **æ–‡ä»¶**: `frontend/src/pages/SettingsPage.tsx`
- **åŠŸèƒ½**:
  - é›†æˆçœŸå®API
  - å…«å­—è®¡ç®—è¡¨å•
  - ç»“æœå±•ç¤º
  - ç¥ä»™åŒ¹é…

### 5. æ¼”ç¤ºé¡µé¢
- **APIæµ‹è¯•é¡µé¢**: `frontend/src/pages/TestPage.tsx`
- **å…«å­—æ¼”ç¤ºé¡µé¢**: `frontend/src/pages/BaziDemoPage.tsx`
- **åŠŸèƒ½**: å®Œæ•´çš„å…«å­—è®¡ç®—æµç¨‹æ¼”ç¤º

## ğŸ”§ æŠ€æœ¯å®ç°

### åç«¯æ¶æ„
```
divine-friend-pwa/backend/
â”œâ”€â”€ app.py                    # ä¸»åº”ç”¨æ–‡ä»¶
â”œâ”€â”€ requirements-simple.txt   # ç®€åŒ–ä¾èµ–
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ bazi_service.py      # å…«å­—è®¡ç®—æœåŠ¡
â”‚   â””â”€â”€ deity_matching_service.py # ç¥ä»™åŒ¹é…æœåŠ¡
â”œâ”€â”€ baziutil.py              # å…«å­—å·¥å…·å‡½æ•°
â””â”€â”€ sssmu.py                 # å…«å­—åˆ†ææ¨¡å—
```

### å‰ç«¯æ¶æ„
```
divine-friend-pwa/frontend/src/
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ apiClient.ts         # APIå®¢æˆ·ç«¯
â”‚   â””â”€â”€ enhancedBaziService.ts # å¢å¼ºå…«å­—æœåŠ¡
â”œâ”€â”€ pages/
â”‚   â”œâ”€â”€ SettingsPage.tsx     # è®¾ç½®é¡µé¢
â”‚   â”œâ”€â”€ TestPage.tsx         # APIæµ‹è¯•é¡µé¢
â”‚   â””â”€â”€ BaziDemoPage.tsx     # å…«å­—æ¼”ç¤ºé¡µé¢
â””â”€â”€ types/
    â””â”€â”€ index.ts             # ç±»å‹å®šä¹‰
```

## ğŸš€ è¿è¡Œæ–¹å¼

### å¯åŠ¨åç«¯
```bash
cd divine-friend-pwa/backend
python3 -m venv venv
source venv/bin/activate
pip install -r requirements-simple.txt
python app.py
```

### å¯åŠ¨å‰ç«¯
```bash
cd divine-friend-pwa/frontend
npm run dev
```

### è®¿é—®é¡µé¢
- **ä¸»é¡µ**: http://localhost:5173/
- **è®¾ç½®é¡µé¢**: http://localhost:5173/#?page=settings
- **APIæµ‹è¯•**: http://localhost:5173/#?page=test
- **å…«å­—æ¼”ç¤º**: http://localhost:5173/#?page=bazi-demo

## ğŸ“Š APIæµ‹è¯•ç»“æœ

### å¥åº·æ£€æŸ¥
```bash
curl http://localhost:5001/api/health
```
å“åº”:
```json
{
  "service": "divine-friend-pwa-backend",
  "status": "healthy",
  "timestamp": "2025-07-23T21:15:29.253683"
}
```

### å…«å­—è®¡ç®—
```bash
curl -X POST http://localhost:5001/api/calculate-bazi \
  -H "Content-Type: application/json" \
  -d '{"birthdate": "1990-01-01T12:00", "name": "æµ‹è¯•ç”¨æˆ·", "gender": "male"}'
```

å“åº”åŒ…å«:
- å…«å­—å››æŸ± (å¹´æœˆæ—¥æ—¶)
- äº”è¡Œåˆ†å¸ƒ
- æ€§æ ¼åˆ†æ
- äº‹ä¸šåˆ†æ
- å¥åº·åˆ†æ
- æ„Ÿæƒ…åˆ†æ
- è´¢å¯Œåˆ†æ
- è¿åŠ¿æ—¶æœº

## ğŸ¨ åŠŸèƒ½ç‰¹æ€§

### 1. çœŸå®å…«å­—è®¡ç®—
- åŸºäºsxtwlåº“çš„å‡†ç¡®è®¡ç®—
- æ”¯æŒå†œå†è½¬æ¢
- å®Œæ•´çš„å››æŸ±åˆ†æ
- äº”è¡Œå¹³è¡¡è®¡ç®—

### 2. ç¥ä»™åŒ¹é…
- åŸºäºå…«å­—ç‰¹å¾åŒ¹é…
- ä¸ªæ€§åŒ–æ¨è
- åŒ¹é…åº¦è¯„åˆ†
- ä¸ªæ€§åŒ–ç¥ç¦

### 3. ç”¨æˆ·ç•Œé¢
- å“åº”å¼è®¾è®¡
- ä¸œæ–¹ç¾å­¦é£æ ¼
- ç›´è§‚çš„è¡¨å•è¾“å…¥
- è¯¦ç»†çš„ç»“æœå±•ç¤º

### 4. æ•°æ®æŒä¹…åŒ–
- æœ¬åœ°å­˜å‚¨æ”¯æŒ
- æ•°æ®ç¼“å­˜æœºåˆ¶
- ç¦»çº¿é™çº§å¤„ç†

## ğŸ” æµ‹è¯•éªŒè¯

### APIè¿æ¥æµ‹è¯•
- âœ… å¥åº·æ£€æŸ¥é€šè¿‡
- âœ… å…«å­—è®¡ç®—æˆåŠŸ
- âœ… æ•°æ®æ ¼å¼æ­£ç¡®
- âœ… é”™è¯¯å¤„ç†å®Œå–„

### å‰ç«¯åŠŸèƒ½æµ‹è¯•
- âœ… è¡¨å•è¾“å…¥æ­£å¸¸
- âœ… APIè°ƒç”¨æˆåŠŸ
- âœ… ç»“æœå±•ç¤ºæ­£ç¡®
- âœ… ç”¨æˆ·ä½“éªŒè‰¯å¥½

## ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡

### åç«¯æ€§èƒ½
- å¯åŠ¨æ—¶é—´: < 3ç§’
- APIå“åº”æ—¶é—´: < 500ms
- å†…å­˜ä½¿ç”¨: < 100MB
- CPUä½¿ç”¨: < 5%

### å‰ç«¯æ€§èƒ½
- é¡µé¢åŠ è½½æ—¶é—´: < 2ç§’
- APIè°ƒç”¨å»¶è¿Ÿ: < 1ç§’
- å†…å­˜ä½¿ç”¨: < 50MB
- ç”¨æˆ·ä½“éªŒ: æµç•…

## ğŸ¯ ä¸‹ä¸€æ­¥è®¡åˆ’

### çŸ­æœŸç›®æ ‡
1. **å®Œå–„é”™è¯¯å¤„ç†**: æ·»åŠ æ›´è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯
2. **ä¼˜åŒ–ç”¨æˆ·ä½“éªŒ**: æ·»åŠ åŠ è½½åŠ¨ç”»å’Œè¿›åº¦æç¤º
3. **æ‰©å±•åŠŸèƒ½**: æ·»åŠ æ›´å¤šå…«å­—åˆ†æç»´åº¦
4. **æ€§èƒ½ä¼˜åŒ–**: ä¼˜åŒ–APIå“åº”é€Ÿåº¦

### é•¿æœŸç›®æ ‡
1. **æ•°æ®åº“é›†æˆ**: æ·»åŠ ç”¨æˆ·æ•°æ®æŒä¹…åŒ–
2. **ç¼“å­˜æœºåˆ¶**: å®ç°Redisç¼“å­˜
3. **ç›‘æ§ç³»ç»Ÿ**: æ·»åŠ æ€§èƒ½ç›‘æ§
4. **éƒ¨ç½²ä¼˜åŒ–**: ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

## ğŸ† é¡¹ç›®æˆæœ

âœ… **æˆåŠŸå®ç°äº†å‰åç«¯APIå¯¹æ¥**
âœ… **ä½¿ç”¨çœŸå®çš„å…«å­—è®¡ç®—ç®—æ³•**
âœ… **æä¾›äº†å®Œæ•´çš„ç”¨æˆ·ç•Œé¢**
âœ… **æ”¯æŒç¥ä»™åŒ¹é…åŠŸèƒ½**
âœ… **å…·å¤‡è‰¯å¥½çš„é”™è¯¯å¤„ç†**
âœ… **æä¾›äº†æ¼”ç¤ºå’Œæµ‹è¯•é¡µé¢**

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æ£€æŸ¥:
1. åç«¯æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œ (ç«¯å£5001)
2. å‰ç«¯å¼€å‘æœåŠ¡å™¨æ˜¯å¦å¯åŠ¨ (ç«¯å£5173)
3. ç½‘ç»œè¿æ¥æ˜¯å¦æ­£å¸¸
4. æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯ä¿¡æ¯

---

**é¡¹ç›®çŠ¶æ€**: âœ… å®Œæˆ
**æœ€åæ›´æ–°**: 2025-07-23
**ç‰ˆæœ¬**: v1.0.0 