# 🤖 DeepSeek API 配置指南

## 📋 概述

本项目集成了 DeepSeek API 来实现真正的神仙对话功能。每位神仙都有独特的性格设定和专业领域，通过AI技术提供个性化的智慧指引。

## 🔑 获取 API Key

### 1. 注册 DeepSeek 账号
- 访问：https://platform.deepseek.com/
- 点击"注册"创建新账号
- 完成邮箱验证

### 2. 创建 API Key
- 登录后进入控制台
- 导航到 "API Keys" 页面
- 点击 "Create API Key"
- 复制生成的 API Key（请妥善保存）

### 3. 充值额度
- 进入"充值"页面
- 选择合适的充值金额
- 完成支付（建议先充值少量进行测试）

## ⚙️ 项目配置

### 1. 创建环境变量文件
在项目根目录 `divine-friend-pwa/frontend/` 下创建 `.env.local` 文件：

```bash
# 在 divine-friend-pwa/frontend/ 目录下
touch .env.local
```

### 2. 配置 API Key
编辑 `.env.local` 文件，添加以下内容：

```env
# DeepSeek API 配置
VITE_DEEPSEEK_API_KEY=sk-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# 应用配置
VITE_APP_NAME=交个神仙朋友
VITE_APP_VERSION=1.0.0
```

**重要提示：**
- 将 `sk-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx` 替换为你的真实 API Key
- `.env.local` 文件不会被 Git 跟踪，保护密钥安全
- 不要在代码中硬编码 API Key

### 3. 重启开发服务器
配置完成后，重启开发服务器使配置生效：

```bash
cd divine-friend-pwa/frontend
npm run dev
```

## 🧪 测试 API 功能

### 1. 访问测试页面
- 启动应用后，在首页点击 "🤖 AI测试" 按钮
- 或直接访问：http://localhost:5177/ （端口可能不同）

### 2. 测试对话
- 选择不同的神仙进行对话
- 发送消息测试 API 响应
- 观察不同神仙的回复风格

### 3. 功能验证
- ✅ API 密钥配置正确
- ✅ 网络连接正常
- ✅ 消息发送成功
- ✅ 收到神仙回复
- ✅ 不同神仙风格差异明显

## 🎭 神仙角色设定

### 观音菩萨 (guanyin)
- **特长**：慈悲智慧、情感疗愈
- **风格**：温和慈祥，善于倾听和安慰
- **适用场景**：情感问题、人际关系、心灵疗愈

### 不动尊菩萨 (budongzun)
- **特长**：破除障碍、坚定意志
- **风格**：坚定有力，给人勇气和决心
- **适用场景**：克服困难、增强信心、突破障碍

### 大势至菩萨 (dashizhi)
- **特长**：智慧开启、学业事业
- **风格**：逻辑清晰，富有哲理
- **适用场景**：学习规划、事业发展、决策思考

### 大日如来 (dairiruiai)
- **特长**：光明普照、消除业障
- **风格**：充满正能量，净化心灵
- **适用场景**：消除负面情绪、精神提升、心灵净化

### 文殊菩萨 (wenshu)
- **特长**：智慧修行、学问精进
- **风格**：博学多才，启发智慧
- **适用场景**：学习方法、智慧开发、文化修养

### 虚空藏菩萨 (xukong)
- **特长**：财富智慧、心愿成就
- **风格**：神秘而富有深意
- **适用场景**：财富规划、心愿实现、福德修行

### 阿弥陀佛 (amitabha)
- **特长**：慈悲修行、内心平静
- **风格**：慈悲安详，给予安慰
- **适用场景**：心灵安慰、放下执着、修心养性

## 💰 费用估算

### API 调用费用
- **模型**：deepseek-chat
- **计费方式**：按 token 计费
- **预估成本**：每次对话约 0.01-0.05 元人民币
- **建议额度**：测试阶段充值 20-50 元即可

### 优化建议
- 设置合理的 `max_tokens` 限制（默认200）
- 调整 `temperature` 参数控制回复创意度
- 实施请求频率限制，避免过度调用

## 🔧 技术实现

### 架构概览
```
用户输入 → useDeityChat Hook → DeepSeek API → 神仙回复
     ↓              ↓                ↓           ↓
  UI组件      状态管理      HTTP请求      打字效果
```

### 核心文件
- `src/utils/deepseek-api.ts` - API 封装和神仙设定
- `src/hooks/useDeityChat.ts` - 聊天状态管理
- `src/config/api.ts` - API 配置管理
- `src/components/DeepSeekDemo.tsx` - 演示组件

### 特色功能
- 🎭 **多神仙角色**：7位神仙，各具特色
- ⌨️ **打字效果**：模拟真实对话体验
- 🔄 **状态管理**：完整的消息历史和错误处理
- 📱 **移动适配**：响应式设计，触摸友好

## 🛡️ 安全注意事项

### API Key 安全
- ❌ 不要提交 `.env.local` 到代码仓库
- ❌ 不要在客户端代码中硬编码 API Key
- ✅ 使用环境变量管理敏感信息
- ✅ 定期轮换 API Key

### 使用限制
- 设置合理的请求频率限制
- 监控 API 使用量和费用
- 实施用户身份验证（生产环境）
- 添加内容过滤和审核机制

## 🚀 部署注意事项

### 环境变量配置
- 生产环境需要在服务器配置环境变量
- 使用 CI/CD 系统安全管理密钥
- 考虑使用密钥管理服务（如 AWS Secrets Manager）

### 性能优化
- 实施 API 响应缓存
- 添加请求去重机制
- 设置合理的超时时间
- 监控 API 响应时间和成功率

## 📞 技术支持

如果遇到配置问题，请检查：

1. **API Key 是否正确**：确保复制完整且无多余空格
2. **网络连接**：确保能访问 DeepSeek API 服务
3. **环境变量**：确保 `.env.local` 文件位置正确
4. **账户余额**：确保 DeepSeek 账户有足够余额
5. **服务器重启**：修改环境变量后需要重启开发服务器

---

🙏 **愿与神仙朋友的对话为您带来智慧与平静！** 