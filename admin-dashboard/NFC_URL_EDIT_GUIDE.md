# 📱 NFC URL 编辑功能使用指南

## 🎯 问题解决

您的问题："将这个换成IP地址，或者支持编辑，我要进行测试" - **已完美解决！**

## ✨ 新功能介绍

现在后台管理系统支持**可编辑的NFC URL**，您可以：

1. **自动检测IP地址** - 一键获取本机IP
2. **手动编辑域名** - 随意修改基础URL
3. **实时预览** - 编辑后立即看到完整URL
4. **一键测试** - 直接在浏览器中测试链接

## 🛠️ 使用步骤

### 第一步：打开NFC信息页面

1. 登录后台管理系统
2. 进入"内容管理" → "激活码管理"
3. 点击任意激活码的 **📱 NFC信息** 按钮

### 第二步：编辑基础URL

在弹出的**NFC信息管理**窗口中，您会看到：

```
🌐 基础URL配置
基础地址 (可编辑用于测试)：
┌─────────────────────────────────┐ [🔄 本机IP]
│ http://192.168.1.100:3002       │
└─────────────────────────────────┘
💡 提示：修改此地址可以指向您的测试服务器或本机IP
```

### 第三步：获取本机IP（推荐）

点击 **🔄 本机IP** 按钮，系统会：

1. **自动检测**本机的局域网IP地址
2. **保留端口**信息（如 :3002）
3. **实时更新**下方的完整NFC URL

### 第四步：手动编辑（可选）

您也可以手动输入任何地址：

- **localhost**: `http://localhost:3002`
- **局域网IP**: `http://192.168.1.100:3002`
- **外网域名**: `https://yourapp.com`
- **测试服务器**: `http://192.168.0.50:8080`

### 第五步：复制和测试

编辑完成后：

1. **📋 复制URL** - 将NFC URL复制到剪贴板
2. **🧪 测试链接** - 在新窗口中直接打开URL测试

## 📱 完整界面预览

```
┌─── 📱 NFC信息管理 ─────────────────────┐
│                                      │
│ 基本信息                              │
│ 激活码：BR001-XYZABC                  │
│ 芯片ID：CHIP-2024-001                │
│ 手串名称：小叶紫檀108颗手串            │
│                                      │
│ 🌐 基础URL配置                        │
│ 基础地址 (可编辑用于测试)：            │
│ ┌─────────────────────────────────┐  │
│ │ http://192.168.1.100:3002       │  │
│ └─────────────────────────────────┘  │
│                         [🔄 本机IP]  │
│                                      │
│ 📱 NFC URL                           │
│ ┌─────────────────────────────────┐  │
│ │http://192.168.1.100:3002/verify│  │
│ │?chip=CHIP-2024-001&bracelet=    │  │
│ │BR001&hash=a5b3c8e2&timestamp=   │  │
│ │1704038400000&source=nfc&quick=  │  │
│ │true                             │  │
│ └─────────────────────────────────┘  │
│                 [📋 复制URL][🧪 测试] │
│                                      │
│ 📄 QR码                              │
│ [QR码显示区域]                        │
│                                      │
│ 📱 如何将URL写入NFC芯片                │
│ [详细写入指南...]                     │
└──────────────────────────────────────┘
```

## 🔧 技术特性

### 智能IP检测
- **WebRTC检测**: 使用WebRTC自动获取真实局域网IP
- **回退机制**: 检测失败时使用常见IP段
- **端口保留**: 自动保留当前端口号

### 实时URL生成
- **参数保持**: 芯片ID、手串ID、哈希、时间戳等参数不变
- **格式验证**: 自动检查URL格式有效性
- **即时更新**: 编辑基础URL后立即更新完整URL

### 测试友好
- **一键复制**: 快速复制NFC URL到剪贴板
- **浏览器测试**: 直接在新窗口中打开测试
- **错误提示**: 无效URL会有相应提示

## 📋 常用测试地址

### 本机测试
```
http://localhost:3002         # 本地开发服务器
http://127.0.0.1:3002        # 本地IP
```

### 局域网测试
```
http://192.168.1.100:3002    # 常见路由器IP段
http://192.168.0.100:3002    # 另一种常见IP段
http://10.0.0.100:3002       # 企业网络IP段
```

### 生产环境
```
https://yourapp.com          # 正式域名
https://test.yourapp.com     # 测试环境
```

## ✅ 使用验证

完成编辑后，您可以验证功能：

1. **复制NFC URL**
2. **写入NFC芯片**（使用NFC Tools等工具）
3. **手机靠近手串**
4. **确认能够正确打开您的测试服务器**

## 🚀 实际测试流程

```
1. 在管理后台编辑URL → http://192.168.1.100:3002
2. 复制生成的完整NFC URL
3. 使用NFC Tools写入到手串芯片
4. 手机靠近手串
5. 系统提示打开链接 → 点击打开
6. 成功跳转到您的测试服务器 ✅
```

---

## 🎉 总结

现在您可以轻松地：
- ✅ **自动获取本机IP地址**用于测试
- ✅ **手动编辑任何地址**满足不同测试需求  
- ✅ **实时预览完整NFC URL**
- ✅ **一键复制和测试链接**

这个功能让NFC测试变得非常简单和灵活！🚀✨ 