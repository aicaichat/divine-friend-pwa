<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  
  <!-- PWA æ”¯æŒ -->
  <link rel="manifest" href="/manifest.json" />
  <meta name="theme-color" content="#d4af37" />
  <meta name="background-color" content="#f5f4e8" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="default" />
  <meta name="apple-mobile-web-app-title" content="ç¥ä»™æœ‹å‹" />
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="application-name" content="äº¤ä¸ªç¥ä»™æœ‹å‹" />
  
  <!-- iOS å›¾æ ‡ -->
  <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png" />
  <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png" />
  <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png" />
  <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png" />
  <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png" />
  <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png" />
  <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png" />
  <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png" />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png" />
  
  <!-- æ ‡å‡†å›¾æ ‡ -->
  <link rel="icon" type="image/png" sizes="192x192" href="/android-icon-192x192.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="96x96" href="/favicon-96x96.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
  <link rel="icon" href="/favicon.ico" />
  
  <!-- Microsoft ç“¦ç‰‡ -->
  <meta name="msapplication-TileColor" content="#d4af37" />
  <meta name="msapplication-TileImage" content="/ms-icon-144x144.png" />
  
  <!-- SEO ä¼˜åŒ– -->
  <title>äº¤ä¸ªç¥ä»™æœ‹å‹ - ä¸œæ–¹ç¦…æ„çš„AIé™ªä¼´åº”ç”¨</title>
  <meta name="description" content="èåˆä¼ ç»Ÿæ–‡åŒ–ä¸ç°ä»£ç§‘æŠ€çš„æ™ºæ…§é™ªä¼´åº”ç”¨ã€‚ä¸AIç¥ä»™å¯¹è¯ã€å…«å­—å‘½ç†åˆ†æã€NFCå¼€å…‰æ‰‹ä¸²éªŒè¯ã€ç»å…¸è¯µè¯»ï¼Œä½“éªŒäº”åƒå¹´æ–‡åŒ–çš„æ•°å­—åŒ–ä¼ æ‰¿ã€‚" />
  <meta name="keywords" content="AIç¥ä»™,å…«å­—åˆ†æ,å‘½ç†,å¼€å…‰æ‰‹ä¸²,NFCéªŒè¯,ç»å…¸è¯µè¯»,ç¦…æ„,ä¸œæ–¹æ–‡åŒ–,ä¼ ç»Ÿæ–‡åŒ–,æ•°å­—åŒ–,PWA" />
  <meta name="author" content="äº¤ä¸ªç¥ä»™æœ‹å‹å›¢é˜Ÿ" />
  <meta name="robots" content="index, follow" />
  <link rel="canonical" href="https://divine-friend.app/" />
  
  <!-- Open Graph -->
  <meta property="og:title" content="äº¤ä¸ªç¥ä»™æœ‹å‹ - ä¸œæ–¹ç¦…æ„çš„AIé™ªä¼´åº”ç”¨" />
  <meta property="og:description" content="èåˆä¼ ç»Ÿæ–‡åŒ–ä¸ç°ä»£ç§‘æŠ€çš„æ™ºæ…§é™ªä¼´åº”ç”¨ã€‚ä½“éªŒAIç¥ä»™å¯¹è¯ã€å…«å­—åˆ†æã€æ‰‹ä¸²éªŒè¯ç­‰åŠŸèƒ½ã€‚" />
  <meta property="og:image" content="/og-image.png" />
  <meta property="og:url" content="https://divine-friend.app/" />
  <meta property="og:type" content="website" />
  <meta property="og:locale" content="zh_CN" />
  <meta property="og:site_name" content="äº¤ä¸ªç¥ä»™æœ‹å‹" />
  
  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="äº¤ä¸ªç¥ä»™æœ‹å‹ - ä¸œæ–¹ç¦…æ„çš„AIé™ªä¼´åº”ç”¨" />
  <meta name="twitter:description" content="èåˆä¼ ç»Ÿæ–‡åŒ–ä¸ç°ä»£ç§‘æŠ€çš„æ™ºæ…§é™ªä¼´åº”ç”¨" />
  <meta name="twitter:image" content="/twitter-image.png" />
  
  <!-- æ€§èƒ½ä¼˜åŒ– -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link rel="dns-prefetch" href="https://fonts.googleapis.com" />
  <link rel="dns-prefetch" href="https://fonts.gstatic.com" />
  
  <!-- å­—ä½“é¢„åŠ è½½ -->
  <link rel="preload" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@200;300;400;500;600;700;900&family=Ma+Shan+Zheng&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'" />
  <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@200;300;400;500;600;700;900&family=Ma+Shan+Zheng&display=swap"></noscript>
  
  <!-- å…³é”® CSS å†…è” -->
  <style>
    /* å…³é”®æ¸²æŸ“è·¯å¾„ CSS */
    * { box-sizing: border-box; margin: 0; padding: 0; }
    html { 
      scroll-behavior: smooth; 
      font-size: 16px; 
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
    body {
      font-family: 'Noto Serif SC', serif;
      font-weight: 300;
      line-height: 1.8;
      color: #2c2c2c;
      background: linear-gradient(135deg, #f5f4e8 0%, #faf9f0 100%);
      min-height: 100vh;
      letter-spacing: 0.02em;
      text-rendering: optimizeLegibility;
    }
    
    /* åŠ è½½å±å¹• */
    #loading-screen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #f5f4e8 0%, #faf9f0 100%);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 9999;
      transition: opacity 0.5s ease-out;
    }
    
    .loading-content {
      text-align: center;
      color: #2c2c2c;
    }
    
    .loading-icon {
      font-size: 4rem;
      margin-bottom: 1rem;
      animation: float 3s ease-in-out infinite;
    }
    
    .loading-title {
      font-size: 1.5rem;
      margin-bottom: 0.5rem;
      color: #d4af37;
      font-family: 'Ma Shan Zheng', serif;
      font-weight: 400;
    }
    
    .loading-subtitle {
      font-size: 0.9rem;
      opacity: 0.7;
      margin-bottom: 2rem;
    }
    
    .loading-progress {
      width: 200px;
      height: 3px;
      background: rgba(212, 175, 55, 0.2);
      border-radius: 2px;
      overflow: hidden;
      position: relative;
    }
    
    .loading-bar {
      height: 100%;
      background: linear-gradient(90deg, #d4af37, #f4e4aa, #d4af37);
      width: 0%;
      border-radius: 2px;
      animation: loading 2s ease-in-out infinite;
    }
    
    @keyframes float {
      0%, 100% { transform: translateY(0px); }
      50% { transform: translateY(-20px); }
    }
    
    @keyframes loading {
      0% { width: 0%; }
      50% { width: 70%; }
      100% { width: 100%; }
    }
    
    /* éšè—åŠ è½½å±å¹• */
    .loading-hidden {
      opacity: 0;
      pointer-events: none;
    }
    
    /* åº”ç”¨å®¹å™¨ */
    #root {
      min-height: 100vh;
      position: relative;
    }
    
    /* æ—  JavaScript å›é€€ */
    .no-js-message {
      display: none;
      text-align: center;
      padding: 2rem;
      background: #fff3cd;
      color: #856404;
      border: 1px solid #ffeaa7;
      border-radius: 8px;
      margin: 1rem;
    }
  </style>
  
  <!-- Service Worker æ³¨å†Œ -->
  <script>
    // ç¯å¢ƒæ£€æµ‹å’Œåˆå§‹åŒ–
    window.APP_ENV = {
      isProduction: location.hostname !== 'localhost',
      hasServiceWorker: 'serviceWorker' in navigator,
      hasNotifications: 'Notification' in window,
      hasGeolocation: 'geolocation' in navigator,
      hasCrypto: 'crypto' in window && 'subtle' in crypto,
      userAgent: navigator.userAgent,
      language: navigator.language || navigator.userLanguage || 'zh-CN',
      platform: navigator.platform,
      cookieEnabled: navigator.cookieEnabled,
      onLine: navigator.onLine
    }
    
    // Service Worker æ³¨å†Œ
    if (window.APP_ENV.hasServiceWorker && window.APP_ENV.isProduction) {
      window.addEventListener('load', async () => {
        try {
          const registration = await navigator.serviceWorker.register('/sw.js', {
            scope: '/',
            updateViaCache: 'none'
          })
          
          console.log('ğŸŒŸ Service Worker æ³¨å†ŒæˆåŠŸ:', registration.scope)
          
          // ç›‘å¬æ›´æ–°
          registration.addEventListener('updatefound', () => {
            const newWorker = registration.installing
            newWorker.addEventListener('statechange', () => {
              if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                // æ–°ç‰ˆæœ¬å¯ç”¨
                showUpdateNotification()
              }
            })
          })
          
        } catch (error) {
          console.error('âŒ Service Worker æ³¨å†Œå¤±è´¥:', error)
        }
      })
    } else if (window.APP_ENV.hasServiceWorker) {
      // å¼€å‘ç¯å¢ƒæ¸…ç†æ—§çš„ Service Worker
      navigator.serviceWorker.getRegistrations().then(registrations => {
        registrations.forEach(registration => registration.unregister())
      })
    }
    
    // æ›´æ–°é€šçŸ¥
    function showUpdateNotification() {
      if ('Notification' in window && Notification.permission === 'granted') {
        new Notification('äº¤ä¸ªç¥ä»™æœ‹å‹', {
          body: 'åº”ç”¨æœ‰æ–°ç‰ˆæœ¬å¯ç”¨ï¼Œè¯·åˆ·æ–°é¡µé¢è·å–æœ€æ–°åŠŸèƒ½',
          icon: '/icon-192x192.png',
          tag: 'app-update',
          actions: [
            { action: 'refresh', title: 'ç«‹å³æ›´æ–°' },
            { action: 'dismiss', title: 'ç¨åæ›´æ–°' }
          ]
        })
      }
    }
    
    // ç¦»çº¿/åœ¨çº¿çŠ¶æ€ç›‘å¬
    window.addEventListener('online', () => {
      console.log('ğŸŒ ç½‘ç»œå·²è¿æ¥')
      document.body.classList.remove('offline')
    })
    
    window.addEventListener('offline', () => {
      console.log('ğŸ“µ ç½‘ç»œå·²æ–­å¼€')
      document.body.classList.add('offline')
    })
    
    // é¡µé¢å¯è§æ€§ç›‘å¬
    document.addEventListener('visibilitychange', () => {
      if (document.hidden) {
        console.log('ğŸ‘€ é¡µé¢éšè—')
      } else {
        console.log('ğŸ‘ï¸ é¡µé¢å¯è§')
      }
    })
    
    // åŠ è½½è¿›åº¦æ¨¡æ‹Ÿ
    let loadingProgress = 0
    const loadingBar = document.querySelector('.loading-bar')
    const loadingInterval = setInterval(() => {
      loadingProgress += Math.random() * 15
      if (loadingProgress >= 100) {
        loadingProgress = 100
        clearInterval(loadingInterval)
      }
      if (loadingBar) {
        loadingBar.style.width = loadingProgress + '%'
      }
    }, 100)
    
    // åº”ç”¨åŠ è½½å®Œæˆåéšè—åŠ è½½å±å¹•
    window.addEventListener('load', () => {
      setTimeout(() => {
        const loadingScreen = document.getElementById('loading-screen')
        if (loadingScreen) {
          loadingScreen.classList.add('loading-hidden')
          setTimeout(() => {
            loadingScreen.style.display = 'none'
          }, 500)
        }
      }, 1000)
    })
  </script>
  
  <!-- é”™è¯¯å¤„ç† -->
  <script>
    window.addEventListener('error', (event) => {
      console.error('ğŸš¨ é¡µé¢é”™è¯¯:', event.error)
      // è¿™é‡Œå¯ä»¥å‘é€é”™è¯¯æŠ¥å‘Šåˆ°æœåŠ¡å™¨
    })
    
    window.addEventListener('unhandledrejection', (event) => {
      console.error('ğŸš¨ æœªå¤„ç†çš„ Promise æ‹’ç»:', event.reason)
      // è¿™é‡Œå¯ä»¥å‘é€é”™è¯¯æŠ¥å‘Šåˆ°æœåŠ¡å™¨
    })
  </script>
  <script type="module" crossorigin src="/assets/index-b61e2580.js"></script>
  <link rel="stylesheet" href="/assets/index-1aa60aba.css">
</head>
<body>
  <!-- æ—  JavaScript å›é€€ -->
  <noscript>
    <div class="no-js-message">
      <h2>éœ€è¦å¯ç”¨ JavaScript</h2>
      <p>äº¤ä¸ªç¥ä»™æœ‹å‹éœ€è¦ JavaScript æ‰èƒ½æ­£å¸¸è¿è¡Œã€‚è¯·åœ¨æµè§ˆå™¨è®¾ç½®ä¸­å¯ç”¨ JavaScript ååˆ·æ–°é¡µé¢ã€‚</p>
    </div>
  </noscript>
  
  <!-- åŠ è½½å±å¹• -->
  <div id="loading-screen">
    <div class="loading-content">
      <div class="loading-icon">ğŸ™</div>
      <h1 class="loading-title">äº¤ä¸ªç¥ä»™æœ‹å‹</h1>
      <p class="loading-subtitle">æ­£åœ¨åŠ è½½ä¸œæ–¹æ™ºæ…§...</p>
      <div class="loading-progress">
        <div class="loading-bar"></div>
      </div>
    </div>
  </div>
  
  <!-- åº”ç”¨æ ¹å®¹å™¨ -->
  <div id="root"></div>
  
  <!-- åº”ç”¨å…¥å£ -->
  
  
  <!-- æ€§èƒ½ç›‘æ§ -->
  <script>
    // æ€§èƒ½æŒ‡æ ‡æ”¶é›†
    window.addEventListener('load', () => {
      setTimeout(() => {
        const perfData = performance.getEntriesByType('navigation')[0]
        const paintEntries = performance.getEntriesByType('paint')
        
        const metrics = {
          // é¡µé¢åŠ è½½æŒ‡æ ‡
          domContentLoaded: perfData.domContentLoadedEventEnd - perfData.domContentLoadedEventStart,
          loadComplete: perfData.loadEventEnd - perfData.loadEventStart,
          
          // æ¸²æŸ“æŒ‡æ ‡
          firstPaint: paintEntries.find(entry => entry.name === 'first-paint')?.startTime || 0,
          firstContentfulPaint: paintEntries.find(entry => entry.name === 'first-contentful-paint')?.startTime || 0,
          
          // ç½‘ç»œæŒ‡æ ‡
          dnsLookup: perfData.domainLookupEnd - perfData.domainLookupStart,
          tcpConnect: perfData.connectEnd - perfData.connectStart,
          
          // ç”¨æˆ·ä½“éªŒæŒ‡æ ‡
          timeToInteractive: Date.now() - performance.timing.navigationStart
        }
        
        console.log('ğŸ“Š æ€§èƒ½æŒ‡æ ‡:', metrics)
        
        // è¿™é‡Œå¯ä»¥å‘é€æ€§èƒ½æ•°æ®åˆ°åˆ†ææœåŠ¡
        if (window.APP_ENV.isProduction) {
          // sendAnalytics('performance', metrics)
        }
      }, 1000)
    })
  </script>
  
  <!-- ç”¨æˆ·ä½“éªŒå¢å¼º -->
  <script>
    // é˜²æ­¢é¡µé¢é—ªçƒ
    document.documentElement.style.visibility = 'visible'
    
    // è§¦æ‘¸åé¦ˆä¼˜åŒ–
    if ('ontouchstart' in window) {
      document.body.classList.add('touch-enabled')
    }
    
    // æ·±è‰²æ¨¡å¼æ£€æµ‹
    if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
      document.body.classList.add('dark-mode-preferred')
    }
    
    // å‡å°‘åŠ¨ç”»åå¥½æ£€æµ‹
    if (window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
      document.body.classList.add('reduced-motion')
    }
    
    // å±å¹•æ–¹å‘å˜åŒ–å¤„ç†
    window.addEventListener('orientationchange', () => {
      setTimeout(() => {
        window.scrollTo(0, 0)
      }, 100)
    })
  </script>
</body>
</html>
