<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç”¨æˆ·çŠ¶æ€è°ƒè¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #1a1a1a;
            color: white;
        }
        .debug-section {
            background: #2a2a2a;
            padding: 20px;
            margin: 20px 0;
            border-radius: 10px;
            border: 1px solid #444;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
        }
        .status.true { background: #4CAF50; }
        .status.false { background: #f44336; }
        .data-display {
            background: #333;
            padding: 15px;
            border-radius: 5px;
            font-family: monospace;
            white-space: pre-wrap;
            word-break: break-all;
        }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #0056b3;
        }
        .clear-btn {
            background: #dc3545;
        }
        .clear-btn:hover {
            background: #c82333;
        }
    </style>
</head>
<body>
    <h1>ğŸ” ç”¨æˆ·çŠ¶æ€è°ƒè¯•å·¥å…·</h1>
    
    <div class="debug-section">
        <h2>ğŸ“Š å½“å‰çŠ¶æ€</h2>
        <div id="current-status"></div>
    </div>
    
    <div class="debug-section">
        <h2>ğŸ“± localStorage æ•°æ®</h2>
        <div id="localstorage-data"></div>
    </div>
    
    <div class="debug-section">
        <h2>ğŸ”§ æ“ä½œ</h2>
        <button onclick="checkState()">ğŸ”„ åˆ·æ–°çŠ¶æ€</button>
        <button onclick="clearUserInfo()" class="clear-btn">ğŸ—‘ï¸ æ¸…é™¤ç”¨æˆ·ä¿¡æ¯</button>
        <button onclick="clearBracelet()" class="clear-btn">ğŸ—‘ï¸ æ¸…é™¤æ‰‹ä¸²çŠ¶æ€</button>
        <button onclick="setTestData()">ğŸ§ª è®¾ç½®æµ‹è¯•æ•°æ®</button>
    </div>
    
    <div class="debug-section">
        <h2>ğŸ¯ é¢„æœŸè¡Œä¸º</h2>
        <p><strong>å¦‚æœ hasBaziSetup = false:</strong> æŒ‰é’®åº”æ˜¾ç¤º"ğŸ”® è®¾ç½®å…«å­—ä¿¡æ¯"</p>
        <p><strong>å¦‚æœ hasBaziSetup = true:</strong> æŒ‰é’®åº”æ˜¾ç¤º"ğŸ“¿ æ¿€æ´»æ‰‹ä¸²"</p>
        <p><strong>å¦‚æœ hasBaziSetup = true ä¸” hasBraceletActivated = true:</strong> å¼•å¯¼å¡ç‰‡åº”éšè—</p>
    </div>

    <script>
        function checkState() {
            const userInfo = localStorage.getItem('userInfo');
            const braceletActivated = localStorage.getItem('braceletActivated');
            
            let parsedUserInfo = null;
            let hasBaziSetup = false;
            let hasBraceletActivated = false;
            
            if (userInfo) {
                try {
                    parsedUserInfo = JSON.parse(userInfo);
                    hasBaziSetup = !!(parsedUserInfo.birthdate && parsedUserInfo.name && parsedUserInfo.gender);
                } catch (e) {
                    console.error('è§£æç”¨æˆ·ä¿¡æ¯å¤±è´¥:', e);
                }
            }
            
            hasBraceletActivated = braceletActivated === 'true';
            
            // æ˜¾ç¤ºå½“å‰çŠ¶æ€
            const statusHtml = `
                <div class="status ${hasBaziSetup ? 'true' : 'false'}">
                    <strong>hasBaziSetup:</strong> ${hasBaziSetup} 
                    ${hasBaziSetup ? 'âœ…' : 'âŒ'}
                </div>
                <div class="status ${hasBraceletActivated ? 'true' : 'false'}">
                    <strong>hasBraceletActivated:</strong> ${hasBraceletActivated}
                    ${hasBraceletActivated ? 'âœ…' : 'âŒ'}
                </div>
                <div class="status ${hasBaziSetup && hasBraceletActivated ? 'true' : 'false'}">
                    <strong>å®Œå…¨è®¾ç½®:</strong> ${hasBaziSetup && hasBraceletActivated}
                    ${hasBaziSetup && hasBraceletActivated ? 'âœ…' : 'âŒ'}
                </div>
            `;
            
            document.getElementById('current-status').innerHTML = statusHtml;
            
            // æ˜¾ç¤º localStorage æ•°æ®
            const dataHtml = `
                <strong>userInfo:</strong>
                ${userInfo ? JSON.stringify(parsedUserInfo, null, 2) : 'null'}
                
                <strong>braceletActivated:</strong>
                ${braceletActivated || 'null'}
            `;
            
            document.getElementById('localstorage-data').innerHTML = `<div class="data-display">${dataHtml}</div>`;
        }
        
        function clearUserInfo() {
            localStorage.removeItem('userInfo');
            alert('ç”¨æˆ·ä¿¡æ¯å·²æ¸…é™¤');
            checkState();
        }
        
        function clearBracelet() {
            localStorage.removeItem('braceletActivated');
            alert('æ‰‹ä¸²çŠ¶æ€å·²æ¸…é™¤');
            checkState();
        }
        
        function setTestData() {
            const testUserInfo = {
                name: 'æµ‹è¯•ç”¨æˆ·',
                gender: 'male',
                birthdate: '1990-01-01'
            };
            localStorage.setItem('userInfo', JSON.stringify(testUserInfo));
            localStorage.setItem('braceletActivated', 'false');
            alert('æµ‹è¯•æ•°æ®å·²è®¾ç½®');
            checkState();
        }
        
        // é¡µé¢åŠ è½½æ—¶æ£€æŸ¥çŠ¶æ€
        checkState();
    </script>
</body>
</html> 